## Scan

### NMAP
```
nmap -A -Pn -n --top-ports 10000 -vvv -oN 192.168.27.68
nmap -sV -T5 -F -A 10.11.1.5 --open --script vuln
nmap -A -Pn -sC 10.11.1.8
nmap 10.11.1.125 --script ftp*
nmap -oN nmap2.txt -v -sU -sS -p- -A -T4 $ip
```
### NIKTO
```
nikto -h 10.10.10.10:8000
```

### DIRBUSTER
```
dirb http://10.11.1.31
```



### FTP - 21

```
nmap -v -p 21 --script=ftp-anon.nse $ip-25
```

Connect and get file via FTP
```
anonymous:anonymous
cd "Documents and Settings"
get servers.py

ls ../../../../../../../../../../../Docume~1/Administrateur/Bureau/
get
(remote-file) ../../../../../../../../../../../Docume~1/Administrateur/Bureau/proof.txt
(local-file) /root/Desktop/10.11.1.125.txt
```

### SMTP - 25

```
nc -nv $ip 25
```

### DNS - 53

```
dig a domain-name-here.com @nameserver
dig axfr domain-name-here.com @nameserver
dnsenum zonetransfer.me
```

### HTTP - 80,443 etc

Search folder
```
gobuster -w /usr/share/wordlists/dirb/common.txt -u $ip
dirb http://$ip/ wordlist.dict dirb <http://vm/>
dirb [http://$ip/](http://172.16.0.19/) -p $ip:<proxyPort>
uniscan -qweds -u <http://vm/>
```

Nikto
```
nikto -h $ip
```

WORDPRESS

```
wpscan -u "http://10.11.1.234" --wordlist /usr/share/wordlists/rockyou.txt --username admin
wpscan --url $ip/blog --proxy $ip:3129
```

### POP3 - 110

POP3 Enumeration
```
telnet $ip 110
USER billydean
PASS password
list
retr 1
```

### NFC - 111

Show Mountable NFS Shares
```
nmap -sV --script=nfs-showmount $ip
```

### RPC - 135, 389

```
rpcclient --user="" --command=enumprivs -N $ip
```

### SMB - 139, 445

SMB Enumeration Tools
```
enum4linux 10.11.1.8
smbclient //10.11.1.128/wwwroot
smbclient -L 10.11.1.128
rpcclient -U "" $ip
```

SMB OS & Port Scan & All Script
```
nmap $ip --script smb-os-discovery.nse
nmap -v -p 139,445 -oG smb.txt $ip-254
nmap -sV -Pn -vv -p 445 --script='(smb*) and not (brute or broadcast or dos or external or fuzzer)' --script-args=unsafe=1 $ip
nmap -sV -Pn -vv -p 445 --script-args smbuser=<username>,smbpass=<password> --script='(smb*) and not (brute or broadcast or dos or external or fuzzer)' --script-args=unsafe=1 $ip
```

### SNMP - 161,162

```
snmpcheck -t $ip -c public
snmpwalk -c public -v1 $ip 1|
grep hrSWRunName|cut -d\* \* -f
snmpenum -t $ip
onesixtyone -c names -i hosts
nmap -sV -p 161 --script=snmp-info $ip/24
```

SNMP Default Credentials
```
/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt
```

### MSSQL - 1433

Ä°nformation gathering

```
nmap -p 1433 --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER $ip

nmap 10.11.1.31 -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=poiuytrewq,mssql.instance-name=MSSQLSERVER,ms-sql-xp-cmdshell.cmd='type C:\"Documents and Settings"\Administrator\Desktop\proof.txt'
```
